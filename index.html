<!DOCTYPE html>
<meta charset="utf-8">
<head>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body id="page">
<div class="title">
	Health at a Glance: Europe
</div>
<Br/>
<div id="toolbar">
<div class="button active" id="status">Health status </div>
<div class="button " id="factors">Risk factors </div>
<div class="button  " id="quality">Effectiveness/Quality </div>
<div class="button  " id="access">Access to care </div>
<div class="button  " id="careResources">Health expenditure </div>
</div>
<Br/>
<div class="topicExplanation">Life expectancy is a key indicator to understanding the overall health of a population. Three indicators reflecting gender and age-specific life expectancies are presented here. More specific indicators on ischaemic heart mortality and dementia prevalence are also shown, two major causes of mortality and morbidity today and in the future.<br/>All data refer to 2016 or nearest year, except for dementia prevalence, which refers to 2017.
</div>
<Br/>
<div class="selector">Highlight a country: 
<select id="dropDownButton" onchange="highlightCountry(this.value)";>
	 <option value="-">-</option>
	<option value="ALB">Albania</option>
	<option value="AUT" selected="selected">Austria</option>
	<option value="BEL">Belgium</option>
	<option value="BGR">Bulgaria</option>
	<option value="HRV">Croatia</option>
	<option value="CYP">Cyprus</option>
	<option value="CZE">Czech Republic</option>
	<option value="DNK">Denmark</option>
	<option value="EST">Estonia</option>
	<!--<option value="EU18">EU18</option>
	<option value="EU20">EU20</option>
	<option value="EU23">EU23</option>
	<option value="EU28">EU28</option>-->
	<option value="FIN">Finland</option>
	<option value="FRA">France</option>
	<option value="DEU">Germany</option>
	<option value="GRC">Greece</option>
	<option value="HUN">Hungary</option>
	<option value="IRL">Ireland</option>
	<option value="ISL">Iceland</option>
	<option value="ITA">Italy</option>
	<option value="LTU">Lithuania</option>
	<option value="LUX">Luxembourg</option>
	<option value="LVA">Latvia</option>
	<option value="MKD">FYR of Macedonia</option>
	<option value="MLT">Malta</option>
	<option value="MNE">Montenegro</option>
	<option value="NLD">Netherlands</option>
	<option value="NOR">Norway</option>
	<option value="POL">Poland</option>
	<option value="PRT">Portugal</option>
	<option value="ROU">Romania</option>
	<option value="SRB">Serbia</option>
	<option value="SVK">Slovak Republic</option>
	<option value="SVN">Slovenia</option>
	<option value="ESP">Spain</option>
	<option value="SWE">Sweden</option>
	<option value="CHE">Switzerland</option>
	<option value="TUR">Turkey</option>
	<option value="GBR">United Kingdom</option>
</select>
</div>
</Br>
<!--<div class="sub"> Countries on the left hand side are <b>bottom performers</b> for the indicators while countries on the right hand side are <b>top performers</b>.-->
</div>	
</Br>

<div class="sector title" id="HealthStatus" >
	Health status
</div>
<div id="Performers"></div>
<br/>
<div class="sector" id="HealthStatus">
	<div class="compareChart">
		<div class="metadata" tooltip="Years of life at birth - 2016">Life expectancy (male)
		</div>
		<span id="MLifeExp"></span>
	</div>
	<div class="compareChart" >
		<div class="metadata" tooltip="Years of life at birth - 2016">Life expectancy (female)
		</div>
		<span id="FLifeExp"></span>
	</div>
	<div class="compareChart" >
		<div class="metadata" tooltip="Years of life at birth - 2016">Life expectancy (total)
		</div>
		<span id="TLifeExp"></span>
	</div>
	<div class="compareChart" >
		<div class="metadata" tooltip="% of population aged 16+ reporting to be in good health- 2016 or nearest year">Percentage of people in good health (low-income people)
		</div>
		<span id="LIRepHltg"></span>
	</div>
	<div class="compareChart" >
		<div class="metadata" tooltip="% of population aged 16+ reporting to be in good health - 2016 or nearest year">Percentage of people in good health (high-income people)
		</div>
		<span id="HIRepHltg"></span>
	</div>
	<div class="compareChart" >
		<div class="metadata" tooltip="% of population aged 16+ reporting to be in good health - 2016 or nearest year">Percentage of people in good health (total)
		</div>
		<span id="TRepHltg"></span>
	</div>
</div>

<Br/>

<div id="source">Visit the <a href="http://www.oecd.org/health/health-at-a-glance-europe-23056088.htm" target="_blank">"Health at a Glance: Europe" website</a> for access to the full report, detailed country notes and more information.</div>
<!--<div id="source">Download the data <a href="http://www.oecd.org/">here</a>.</div>-->	
<Br/>

<div id="footer">The statistical data for Israel are supplied by and under the responsibility of the relevant Israeli authorities. The use of such data by the OECD is without prejudice to the status of the Golan Heights, East Jerusalem and Israeli settlements in the West Bank under the terms of international law.
</div><div id="footerCyprus">
	The information in this document with reference to “Cyprus” relates to the southern part of the Island. There is no single authority representing both Turkish and Greek Cypriot people on the Island. Turkey recognises the Turkish Republic of Northern Cyprus (TRNC). Until a lasting and equitable solution is found within the context of the United Nations, Turkey shall preserve its position concerning the “Cyprus issue”.
	<br />Note by all the European Union Member States of the OECD and the European Union:
	<br />The Republic of Cyprus is recognised by all members of the United Nations with the exception of Turkey. The information in this document relates to the area under the effective control of the Government of the Republic of Cyprus.
</div>

<div class="button btn_share" id="shareLink">
	<object type="image/svg+xml" height="14" width="15" data="img/share_neu.svg">
    </object> Share 
</div>
<div class="siteFooterBar">
        <img src="img/SYMBOL_20cm.png" ></img>
        <!--<div >2017 © OECD</div>-->
</div>
<script src="js/embed.js"></script>


<div id="countryTooltipSetUP" class="hidden">
              <p><span id="countryTooltip">All</span></p>
              <p><span id="indicTooltip">All</span></p>
              <p><span id="valueTooltip">All</span></p><Br/>

</div>
</body>
<script src="js/cookie.js"></script>
<script src="libs/d3.v4.min.js"></script>
<script src="js/setupButtons.js"></script>
<script type="text/javascript">

var overallwidth=document.getElementById("page").offsetWidth;
var height=45
var width = overallwidth;
var sideMargin=width/5;
var marginLeft=sideMargin;

var marginRight=sideMargin;

var formatNumber = d3.format(".0f");

var format= d3.format(",.1f");


var colorScale = d3.scaleOrdinal()
    .range(["","#963C2D","#8B73B3","#F58221","#9C4174","#5EA9DE"])
    .domain(["","Health status", "Risk factors","Access to care","Quality of care","Health resources"]);

function pickSector(topicSelected){
	if(topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" ||  topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg")
		return "Health status";
};

var x = d3.scaleLinear()
	//.domain([0,100])
    .rangeRound([marginLeft, width-marginRight]);

var legend = d3.select("#Performers")
	    	.append("svg")
	    	.attr("width", width)
	    	.attr("height",height/2);

legend.append("text")
.attr("x",width-marginRight)
.attr("y",height/2.5)
.attr("class","legend")
.attr("text-anchor","middle")
.text("Top Performer")

legend.append("text")
.attr("x",marginLeft)
.attr("y",height/2.5)
.attr("class","legend")
.attr("text-anchor","middle")
.text("Bottom Performer");

function createComparison(topicSelected,countrySel){
test="#"+topicSelected;
	d3.selectAll(test)
		.selectAll("*")
		.remove();

	var idTopic="#"+topicSelected;
	var IDChart="ID"+topicSelected;


	var compChart=d3.select(idTopic)
	    	.append("svg")
	    	.attr("id",topicSelected)
	    	.attr("width", width)
	    	.attr("height",height)
	  		.append("g")
	    	.attr("class","compChart")
	    	.attr("transform", "translate(" + 0 + "," + 0 + ")");

	d3.tsv("data/status_key.tsv", function(error, dataTot) {
		var data =[];
		var yTopic="Y"+topicSelected;

		dataTot.forEach(function(d,i) {
			if(d[topicSelected]!=""){
				data.push( {
					ISO:d.ISO,
	    			Country: d.Country,
	    			value: d[topicSelected],
	    			yearData:d[yTopic]
	  			})
	  		}	
		});

		var minValue = d3.min(data, function(d) { return parseFloat(d.value); });
		var maxValue = d3.max(data, function(d) { return parseFloat(d.value); });

		if(topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" ||  topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg")
			x.domain([minValue,maxValue]) ;
		else
			x.domain([maxValue,minValue]) ;


		compChart.append("line")
			.attr("x1",x(minValue))
			.attr("y1",height/2)
			.attr("x2",x(maxValue))
			.attr("y2",height/2)
	      	.style("stroke", "#00B7B5")
	      	.style("stroke-width","1px");

		var circleGroup = compChart.selectAll("g")
		    .data(data)
		    .enter()
		    .append("g")
      		.filter(function(d) { return d.ISO==countrySel || d.Country=="EU28"  ||  d.value==minValue || d.value==maxValue })
		    .attr("class", function(d){return d.topic;});

		circleGroup.append("circle")
		    .attr("cx",function(d){
		    	if(d.value!=="")
		    		return x(parseFloat(d.value));})
		    .attr("cy",height/2)
			.attr("r", function(d){
				if((topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" ||  topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg") && d.ISO==countrySel)
					return 12;
				else if(d.ISO==countrySel)
					return 8;

				else if (d.Country=="EU28")
					return 8;
				else
					return 8;
			})
			.style("fill",function(d){
				if(d.ISO==countrySel)
					return "#76A02D"
				else if (d.Country=="EU28")
					return "#0082B5"
				else if (d.value==minValue )
					return colorScale(pickSector(topicSelected))
				else if (d.value==maxValue )
					return colorScale(pickSector(topicSelected))
				else
					return "";
			});



		// EXTREMITY ANNOTATIONS//
		circleGroup.append("text")
			.attr("class","label")
			.attr("dx", function(d){
				if(d.value!==""){
					if(topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" ||  topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg")
				    		return  x(parseFloat(d.value))-12;
					else
							return  12 + x(parseFloat(d.value));
				 }  	
			})
			.attr("dy",height/2)
			.style("text-anchor",function(d){

					if(topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" ||  topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg")
				    		return  "end";
					else
							return  "start";
				  	
			})
			.text(function(d){
				if((d.value==minValue  )&& (d.ISO!=countrySel))
					return format(d.value) ;
	      })

		circleGroup.append("text")
			.attr("class","label")
			.attr("dx", function(d){
				if(d.value!==""){
					if(topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" ||  topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg")
				    		return  12 + x(parseFloat(d.value));
					else
							return  x(parseFloat(d.value))-12;
				 }  	
			})
			.attr("dy",height/2)
			.style("text-anchor",function(d){

					if(topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" ||  topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg")
				    		return  "start";
					else
							return  "end";
				  	
			})
			.text(function(d){
				if(( d.value==maxValue )&& (d.ISO!=countrySel))
					return format(d.value) ;
	      })

		//EU28 and Country annotation/
		circleGroup.append("text")
			.attr("class","label")
			.attr("dx", function(d){
				    	if(d.value!=="")
				    		return x(parseFloat(d.value));})
			.attr("dy",function(d){
				if(d.ISO==countrySel)
					return height/2+20;
				else
					return height/2-12;
			})
			.style("text-anchor","middle")
			.text(function(d){
				if(d.ISO==countrySel || d.ISO=="EU28"){ 
	            //if(d.value!=minValue && d.value!=maxValue ){

		       
		            if (topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" )
		              return  d.Country+ " (" + format(d.value) + " Years"+")";
		            else if(( topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg") )
						return d.Country+ " (" + format(d.value) + " %"+")";
		            else if((topicSelected=="ischaemic" ) )
						return d.Country+ " (" + format(d.value) + " per 100 000"+")";
		            else if((topicSelected=="dementia" ))
						return d.Country+ " (" + format(d.value) + " per 1000"+")";
		            else
		              return  "";
	          	}
	      })



		compChart.selectAll("circle")
			.on("mouseover",function(d){
			d3.select(this)
				.attr("r",function(d){
					if((topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" ||  topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg" ) && d.ISO==countrySel)
						return 14;
					else
						return 10	
				});

			var xPosition = event.pageX-20;
			var yPosition = event.pageY+15;
			if (yPosition>window.innerHeight-200)
				yPosition=yPosition-160;

			//Update the tooltip position and value


		     d3.select("#indicTooltip")
		        .text(function(){
	            	if (topicSelected=="TLifeExp")
	            		return "Life expectancy (total)";
	            	if (topicSelected=="MLifeExp")
	            		return "Life expectancy (male)";
	            	if (topicSelected=="FLifeExp")
	            		return "Life expectancy (female)";
	            	if (topicSelected=="LIRepHltg")
	            		return "Self-reported general health (low-income people)";
	            	if (topicSelected=="HIRepHltg")
	            		return "Self-reported general health (high-income people)" ;
	            	if (topicSelected=="TRepHltg")
	            		return "Self-reported general health (total)" ;
	            });

		     d3.select("#valueTooltip")
		        .text(function(){
			        if (topicSelected=="MLifeExp" || topicSelected=="FLifeExp"|| topicSelected=="TLifeExp")
		              return  format(d.value) + " Years of life at birth";
		            else if( topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg" )
						return format(d.value) + " % of population aged 16 years and over";
        	});






			d3.select("#countryTooltipSetUP")
		        .style("left", xPosition + "px")
		        .style("top", yPosition + "px") 
		        .select("#countryTooltip")
		        .text(d.Country);

			d3.select("#countryTooltipSetUP").classed("hidden", false);


		

		})
		.on("mouseout",function(d){

			var sel = document.getElementById('dropDownButton');

				
				d3.select(this)
				.attr("r",  function(d){
					if((topicSelected=="MLifeExp" ||  topicSelected=="FLifeExp" ||  topicSelected=="TLifeExp" ||  topicSelected=="LIRepHltg" || topicSelected=="HIRepHltg" || topicSelected=="TRepHltg") && d.ISO==countrySel)
						return 12;
					else if(d.ISO==sel.options[sel.selectedIndex].value)
						return 8;
					else if (d.Country=="EU28")
						return 8;
					else
						return 8;
			})
	            
	            //Hide the tooltip
				d3.select("#countryTooltipSetUP").classed("hidden", true);	            

		});



	});
};




function highlightCountry(codeISO){

    document.cookie = 'ISO=' + codeISO;

	createComparison("MLifeExp",codeISO);
	createComparison("FLifeExp",codeISO);
	createComparison("TLifeExp",codeISO);
	createComparison("LIRepHltg",codeISO);
	createComparison("HIRepHltg",codeISO);
	createComparison("TRepHltg",codeISO);
	
	if(codeISO=="ISR"){
  		d3.select("#footer")
  			.style("visibility","visible");
  	}else{
  		d3.select("#footer")
  			.style("visibility","hidden");
  	}
		if (codeISO == "CYP") {
		d3.select("#footerCyprus")
			.style("visibility", "visible");
	} else {
		d3.select("#footerCyprus")
			.style("visibility", "hidden");
	}
}

var e = document.getElementById("dropDownButton");

if(getCookie("ISO")=="" ){
	highlightCountry(e.options[e.selectedIndex].value);
}
else{
	highlightCountry(getCookie("ISO"));
	e.value = getCookie("ISO");
}

setupButtons();


</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51983915-1', 'auto');
  ga('send', 'pageview');

</script>